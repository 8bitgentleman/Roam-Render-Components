[{"create-time":1653864034369,"title":"roam/render",":create/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"},"children":[{"edit-time":1682273494944,"children":[{"string":"**Author**","create-time":1645895706873,":create/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"},"children":[{"string":"Me, [[Matt Vogel]]","create-time":1645895706873,":block/refs":[{":block/uid":"IDmsNojEw"}],"refs":[{"uid":"IDmsNojEw"}],":create/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"},"uid":"qNTd6lHkJ","edit-time":1645895706873,":edit/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"}},{"string":"Twitter:: [@todayIwasbetter](https://twitter.com/todayIwasbetter)","create-time":1645895706873,":block/refs":[{":block/uid":"PZhtzBsoo"}],"refs":[{"uid":"PZhtzBsoo"}],":create/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"},"uid":"idKGz-F2T","edit-time":1645895706873,":edit/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"}},{"string":"How Best To Contact Me:: Twitter is best, Roam Slack is also good","create-time":1645895706873,":block/refs":[{":block/uid":"dcnWgghV5"}],"refs":[{"uid":"dcnWgghV5"}],":create/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"},"uid":"bvFu8APW1","edit-time":1645895706873,":edit/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"}},{"string":"This code is open source! If you have ideas for improvements or run into a bug feel free to fork it or report it over on the [Github repo](https://github.com/8bitgentleman/Roam-Render-Components)","uid":"wYqbf0KI2","create-time":1645895706873,"edit-time":1645895706873,":create/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"},":edit/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"}}],"uid":"s4ZdElW2l","edit-time":1645895706873,":edit/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"}},{"string":"**About Component**","create-time":1645895706873,":create/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"},"children":[{"string":"searches all block children for prices in USD (eg. $10) and sums everything up","uid":"3W0yF6uFh","create-time":1645895706873,"edit-time":1645897138416,":create/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"},":edit/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"}}],"uid":"hPjtoIvMs","edit-time":1645895706873,":edit/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"}},{"edit-time":1682273448996,"children":[{"string":"{{[[roam/render]]:((cZkDibg97))}}","create-time":1645895706873,":block/refs":[{":block/uid":"1EzDSzx0d"},{":block/uid":"cZkDibg97"}],"refs":[{"uid":"1EzDSzx0d"},{"uid":"cZkDibg97"}],":create/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"},"uid":"uzVTFODFw","edit-time":1645895706873,":edit/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"}}],"refs":[{"uid":"jt-y6hvJ0"}],"uid":"htqrMrXYD",":block/refs":[{":block/uid":"jt-y6hvJ0"}],"string":"Shopping list sum price v3 [[roam/templates]]",":create/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"},"create-time":1645895706873,":edit/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"}},{"string":"code","create-time":1645895706873,":create/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"},"children":[{"string":"```clojure\n(ns shopping-sum-v3\n  (:require\n   [reagent.core :as r]\n   [datascript.core :as d]\n   [roam.datascript.reactive :as dr]\n   [clojure.pprint :as pp]))```","uid":"LGmKbS0XE","create-time":1645895706873,"edit-time":1682273462473,":create/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"},":edit/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"}},{"string":"```clojure\n\n\n(defn flatten-block \n  \"Flattens a blocks children into a flat list\"\n  [acc block]\n  (reduce flatten-block\n          (conj acc (dissoc block :block/children))\n          (:block/children block)))\n\n(defn find-child-refs\n  \"Returns all _refs for children blocks given a parent block uid\"\n  [block-uid]\n  (flatten-block []\n             @(dr/q '[:find (pull ?e [:block/string :block/uid {:block/children ...}]) .\n                      :in $ ?uid\n                      :where\n                      [?e :block/uid ?uid]\n                      ]\n                    block-uid)))\n\n(defn filter-content [content]\n  \"finds blocks that contain a price eg. $40. Not acutally used just useful\"\n  (map \n   \t#(re-seq #\".*\\$(\\d+)(?:\\.\\d+)?\" (:block/string %))\n    (filter #(re-seq #\".*\\$(\\d+)(?:\\.\\d+)?\" (:block/string %)) content))\n\t\n\n  )\n\n```","uid":"tY3MRwc24","create-time":1645895706873,"edit-time":1645895764985,":create/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"},":edit/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"}},{"string":"```clojure\n(def log (.-log js/console))\n\n\n(defn sum-string [content]\n  (->> content\n    (re-seq #\"\\$\\d+(?:\\.\\d+)?\" )\n    (map #(subs % 1) )\n    (map float )\n    (reduce +)\n    )\n  )\n\n(defn round-string-sums [uid]\n  (let [sum (->> uid\n      (find-child-refs )\n      (map :block/string )\n      (map sum-string )\n      (map js/parseFloat)\n                 (apply +))\n        rounded-sum (-> (js/Number. sum)\n                        (.toFixed 2))]\n    rounded-sum))\n\n(defn main [{:keys [block-uid]} & args]\n  [:div.rm-shopping-sum {:style{:margin-left \"10px\"}} \"Total Spent: \" \n   [:div.rm-shopping-sum-amount {:style{\n                 :display \"inline-block\"\n                \n                }}\n    \"$\"(round-string-sums block-uid)\n    ]\n     \t\n     ]\n  )\n```","uid":"cZkDibg97","create-time":1645895706873,"edit-time":1682273484862,":create/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"},":edit/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"}}],"uid":"tQz7X1W9W","edit-time":1645895706873,":edit/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"}},{"string":"CSS (Optional)","create-time":1645895706873,":create/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"},"children":[{"string":"__ Move these CSS codeblocks to your __[[roam/css]]__ page__","create-time":1645895706873,":block/refs":[{":block/uid":"0SiJ-RnlK"}],"refs":[{"uid":"0SiJ-RnlK"}],":create/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"},"uid":"l2byC1s_n","edit-time":1645895706873,":edit/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"}},{"string":"Component Styling","create-time":1645895706873,":create/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"},"children":[{"string":"```css\n.rm-shopping-sum{\n  \n}\n.rm-shopping-sum-amount{\n  border: 2px solid #CD3838;\n  padding: 2px 4px;\n  color: #CD3838;\n  font-weight: bold;\n}\n\n```","uid":"xYcotyOPh","create-time":1645895706873,"edit-time":1645895999731,":create/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"},":edit/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"}}],"uid":"UDOEY9Ww9","edit-time":1645895706873,":edit/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"}}],"uid":"gCo2VD1lw","edit-time":1645895706873,":edit/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"}}],"refs":[{"uid":"04-23-2023"}],"uid":"LAeJe085V",":block/refs":[{":block/uid":"04-23-2023"}],"string":"Shopping list sum price v3 [[April 23rd, 2023]]",":create/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"},"create-time":1645895704829,":edit/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"}}],"uid":"1EzDSzx0d","edit-time":1653864034369,":edit/user":{":user/uid":"rTvmoxu9FGSWal8SbCZiywCL2Nm1"}}]